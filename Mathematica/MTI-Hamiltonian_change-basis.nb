(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 13.2' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     28152,        826]
NotebookOptionsPosition[     25586,        770]
NotebookOutlinePosition[     26001,        787]
CellTagsIndexPosition[     25958,        784]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["MTI Hamiltonian", "Section",ExpressionUUID->"a97cb485-0f6a-4fe5-9e1f-659489226105"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"s0", "=", 
   RowBox[{"PauliMatrix", "[", "0", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"sx", "=", 
   RowBox[{"PauliMatrix", "[", "1", "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"sy", "=", 
   RowBox[{"PauliMatrix", "[", "2", "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"sz", "=", 
    RowBox[{"PauliMatrix", "[", "3", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\n", 
 RowBox[{
  RowBox[{"l0", "=", 
   RowBox[{"PauliMatrix", "[", "0", "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"lx", "=", 
   RowBox[{"PauliMatrix", "[", "1", "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"ly", "=", 
   RowBox[{"PauliMatrix", "[", "2", "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"lz", "=", 
    RowBox[{"PauliMatrix", "[", "3", "]"}]}], ";"}], "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"E0", "[", 
    RowBox[{"kx_", ",", "ky_", ",", "kz_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"C0", "+", 
      RowBox[{"D1", "*", 
       RowBox[{"kz", "^", "2"}]}], "+", 
      RowBox[{"D2", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"kx", "^", "2"}], "+", 
         RowBox[{"ky", "^", "2"}]}], ")"}]}]}], ")"}], "*", 
    RowBox[{"KroneckerProduct", "[", 
     RowBox[{"s0", ",", "l0"}], "]"}]}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"E0", "[", 
    RowBox[{"kx", ",", "ky", ",", "kz"}], "]"}], ";"}], "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"Mk", "[", 
    RowBox[{"kx_", ",", "ky_", ",", "kz_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"M", "-", 
      RowBox[{"B1", "*", 
       RowBox[{"kz", "^", "2"}]}], "-", 
      RowBox[{"B2", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"kx", "^", "2"}], "+", 
         RowBox[{"ky", "^", "2"}]}], ")"}]}]}], ")"}], "*", 
    RowBox[{"KroneckerProduct", "[", 
     RowBox[{"s0", ",", "lz"}], "]"}]}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"Mk", "[", 
    RowBox[{"kx", ",", "ky", ",", "kz"}], "]"}], ";"}], "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"A", "[", 
    RowBox[{"kx_", ",", "ky_", ",", "kz_"}], "]"}], ":=", " ", 
   RowBox[{
    RowBox[{"A1", "*", "kz", "*", 
     RowBox[{"KroneckerProduct", "[", 
      RowBox[{"sz", ",", "lx"}], "]"}]}], "+", 
    RowBox[{"A2", "*", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"kx", "*", 
        RowBox[{"KroneckerProduct", "[", 
         RowBox[{"sx", ",", "lx"}], "]"}]}], "+", 
       RowBox[{"ky", "*", 
        RowBox[{"KroneckerProduct", "[", 
         RowBox[{"sy", ",", "lx"}], "]"}]}]}], ")"}]}]}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"A", "[", 
    RowBox[{"kx", ",", "ky", ",", "kz"}], "]"}], ";"}], "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"HMTI", "[", 
     RowBox[{"kx_", ",", "ky_", ",", "kz_"}], "]"}], ":=", "\n", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"E0", "[", 
         RowBox[{"kx", ",", "ky", ",", "kz"}], "]"}], "+", 
        RowBox[{"A", "[", 
         RowBox[{"kx", ",", "ky", ",", "kz"}], "]"}], "+", 
        RowBox[{"Mk", "[", 
         RowBox[{"kx", ",", "ky", ",", "kz"}], "]"}], "+", 
        RowBox[{"\[CapitalLambda]", "*", 
         RowBox[{"KroneckerProduct", "[", 
          RowBox[{"sz", ",", "l0"}], "]"}]}]}], ")"}], "//.", 
      RowBox[{"{", "\n", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"kx", "^", "2"}], "+", 
          RowBox[{"ky", "^", "2"}]}], "\[Rule]", 
         RowBox[{"k", "^", "2"}]}], ",", "\n", 
        RowBox[{
         RowBox[{"C0", "+", 
          RowBox[{"D2", "*", 
           RowBox[{"k", "^", "2"}]}]}], "\[Rule]", "\[Epsilon]0"}], ",", "\n", 
        RowBox[{
         RowBox[{"M", "-", 
          RowBox[{"B2", "*", 
           RowBox[{"k", "^", "2"}]}]}], "\[Rule]", "\[Mu]0"}], ",", "\n", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "M"}], "+", 
          RowBox[{"B2", "*", 
           RowBox[{"k", "^", "2"}]}]}], "\[Rule]", 
         RowBox[{"-", "\[Mu]0"}]}]}], "}"}]}], "//", "FullSimplify"}]}], 
   ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"HMTI", "[", 
   RowBox[{"kx", ",", "ky", ",", "kz"}], "]"}], "//", 
  "MatrixForm"}]}], "Input",
 CellChangeTimes->{{3.935544812168316*^9, 3.935544814180498*^9}, {
  3.935544847595147*^9, 3.935544858963662*^9}, {3.940404348947564*^9, 
  3.940404413243367*^9}, {3.940404451110914*^9, 3.940404529573083*^9}, {
  3.94040457665232*^9, 3.940404582683136*^9}, {3.940404626147464*^9, 
  3.940404719647917*^9}, {3.940404940200862*^9, 3.940405158540145*^9}, {
  3.940405223408643*^9, 3.9404052240142527`*^9}, {3.9409089931812553`*^9, 
  3.9409090137278013`*^9}, {3.951453832173753*^9, 3.951453886712708*^9}, {
  3.951454378162629*^9, 3.9514543863031883`*^9}, {3.951455326247643*^9, 
  3.951455391708308*^9}, {3.951455500197835*^9, 3.95145557273558*^9}, {
  3.9514556086435432`*^9, 3.951455613150785*^9}, {3.9514556898242702`*^9, 
  3.951455696968844*^9}},
 CellLabel->"In[2]:=",ExpressionUUID->"dd31c27c-cd64-4cc6-a69f-caaea9e55af2"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "B1"}], "+", "D1"}], ")"}], " ", 
        SuperscriptBox["kz", "2"]}], "+", "\[Epsilon]0", "+", 
       "\[CapitalLambda]", "+", "\[Mu]0"}], 
      RowBox[{"A1", " ", "kz"}], "0", 
      RowBox[{"A2", " ", 
       RowBox[{"(", 
        RowBox[{"kx", "-", 
         RowBox[{"\[ImaginaryI]", " ", "ky"}]}], ")"}]}]},
     {
      RowBox[{"A1", " ", "kz"}], 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{"B1", "+", "D1"}], ")"}], " ", 
        SuperscriptBox["kz", "2"]}], "+", "\[Epsilon]0", "+", 
       "\[CapitalLambda]", "-", "\[Mu]0"}], 
      RowBox[{"A2", " ", 
       RowBox[{"(", 
        RowBox[{"kx", "-", 
         RowBox[{"\[ImaginaryI]", " ", "ky"}]}], ")"}]}], "0"},
     {"0", 
      RowBox[{"A2", " ", 
       RowBox[{"(", 
        RowBox[{"kx", "+", 
         RowBox[{"\[ImaginaryI]", " ", "ky"}]}], ")"}]}], 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "B1"}], "+", "D1"}], ")"}], " ", 
        SuperscriptBox["kz", "2"]}], "+", "\[Epsilon]0", "-", 
       "\[CapitalLambda]", "+", "\[Mu]0"}], 
      RowBox[{
       RowBox[{"-", "A1"}], " ", "kz"}]},
     {
      RowBox[{"A2", " ", 
       RowBox[{"(", 
        RowBox[{"kx", "+", 
         RowBox[{"\[ImaginaryI]", " ", "ky"}]}], ")"}]}], "0", 
      RowBox[{
       RowBox[{"-", "A1"}], " ", "kz"}], 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{"B1", "+", "D1"}], ")"}], " ", 
        SuperscriptBox["kz", "2"]}], "+", "\[Epsilon]0", "-", 
       "\[CapitalLambda]", "-", "\[Mu]0"}]}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.9514555699085093`*^9, 3.951455613451626*^9}, {
   3.951455691342222*^9, 3.9514556974290667`*^9}, 3.951456000613015*^9, 
   3.9514689531119413`*^9, 3.951967517664928*^9},
 CellLabel->
  "Out[17]//MatrixForm=",ExpressionUUID->"a72affea-6c57-4c60-99ce-\
7f82550f279e"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"Hblock", "=", 
   RowBox[{
    RowBox[{"HMTI", "[", 
     RowBox[{"kx", ",", "ky", ",", 
      RowBox[{
       RowBox[{"-", "I"}], " ", "\[Delta]z"}]}], "]"}], "//.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"kx", "->", "0"}], ",", 
      RowBox[{"ky", "->", "0"}], ",", 
      RowBox[{"k", "->", "0"}]}], "}"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Hblock", "//", "MatrixForm"}]}], "Input",
 CellChangeTimes->{{3.951455704381095*^9, 3.951455754945712*^9}, {
  3.951455901409502*^9, 3.9514559030782623`*^9}, {3.951457323115074*^9, 
  3.9514573283020563`*^9}},
 CellLabel->"In[18]:=",ExpressionUUID->"1f36291a-a7fe-4fd5-a574-1f96501cc938"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{"B1", "-", "D1"}], ")"}], " ", 
        SuperscriptBox["\[Delta]z", "2"]}], "+", "\[Epsilon]0", "+", 
       "\[CapitalLambda]", "+", "\[Mu]0"}], 
      RowBox[{
       RowBox[{"-", "\[ImaginaryI]"}], " ", "A1", " ", "\[Delta]z"}], "0", 
      "0"},
     {
      RowBox[{
       RowBox[{"-", "\[ImaginaryI]"}], " ", "A1", " ", "\[Delta]z"}], 
      RowBox[{
       RowBox[{"-", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"B1", "+", "D1"}], ")"}], " ", 
          SuperscriptBox["\[Delta]z", "2"]}], ")"}]}], "+", "\[Epsilon]0", 
       "+", "\[CapitalLambda]", "-", "\[Mu]0"}], "0", "0"},
     {"0", "0", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{"B1", "-", "D1"}], ")"}], " ", 
        SuperscriptBox["\[Delta]z", "2"]}], "+", "\[Epsilon]0", "-", 
       "\[CapitalLambda]", "+", "\[Mu]0"}], 
      RowBox[{"\[ImaginaryI]", " ", "A1", " ", "\[Delta]z"}]},
     {"0", "0", 
      RowBox[{"\[ImaginaryI]", " ", "A1", " ", "\[Delta]z"}], 
      RowBox[{
       RowBox[{"-", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"B1", "+", "D1"}], ")"}], " ", 
          SuperscriptBox["\[Delta]z", "2"]}], ")"}]}], "+", "\[Epsilon]0", 
       "-", "\[CapitalLambda]", "-", "\[Mu]0"}]}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.951455752131199*^9, 3.951455755271083*^9}, 
   3.9514559036951227`*^9, 3.951456002652562*^9, 3.951457329406557*^9, 
   3.951468953252104*^9, 3.95196751774352*^9},
 CellLabel->
  "Out[19]//MatrixForm=",ExpressionUUID->"d38e5f0d-653d-4595-bd52-\
272dae6a97c4"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"Hblock", "[", 
    RowBox[{"[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"1", ",", "2"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"1", ",", "2"}], "}"}]}], "]"}], "]"}], ".", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"g11", ",", "g12"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"g21", ",", "g22"}], "}"}]}], "}"}]}], "//", 
  "MatrixForm"}]], "Input",
 CellChangeTimes->{{3.951457499379715*^9, 3.9514575124343243`*^9}, {
  3.951469452634655*^9, 3.951469486352621*^9}},
 CellLabel->"In[20]:=",ExpressionUUID->"680d8430-6ff6-4e17-911d-395abf804446"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      RowBox[{
       RowBox[{
        RowBox[{"-", "\[ImaginaryI]"}], " ", "A1", " ", "g21", " ", 
        "\[Delta]z"}], "+", 
       RowBox[{"g11", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"B1", "-", "D1"}], ")"}], " ", 
           SuperscriptBox["\[Delta]z", "2"]}], "+", "\[Epsilon]0", "+", 
          "\[CapitalLambda]", "+", "\[Mu]0"}], ")"}]}]}], 
      RowBox[{
       RowBox[{
        RowBox[{"-", "\[ImaginaryI]"}], " ", "A1", " ", "g22", " ", 
        "\[Delta]z"}], "+", 
       RowBox[{"g12", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"B1", "-", "D1"}], ")"}], " ", 
           SuperscriptBox["\[Delta]z", "2"]}], "+", "\[Epsilon]0", "+", 
          "\[CapitalLambda]", "+", "\[Mu]0"}], ")"}]}]}]},
     {
      RowBox[{
       RowBox[{
        RowBox[{"-", "\[ImaginaryI]"}], " ", "A1", " ", "g11", " ", 
        "\[Delta]z"}], "+", 
       RowBox[{"g21", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"B1", "+", "D1"}], ")"}], " ", 
             SuperscriptBox["\[Delta]z", "2"]}], ")"}]}], "+", "\[Epsilon]0", 
          "+", "\[CapitalLambda]", "-", "\[Mu]0"}], ")"}]}]}], 
      RowBox[{
       RowBox[{
        RowBox[{"-", "\[ImaginaryI]"}], " ", "A1", " ", "g12", " ", 
        "\[Delta]z"}], "+", 
       RowBox[{"g22", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"B1", "+", "D1"}], ")"}], " ", 
             SuperscriptBox["\[Delta]z", "2"]}], ")"}]}], "+", "\[Epsilon]0", 
          "+", "\[CapitalLambda]", "-", "\[Mu]0"}], ")"}]}]}]}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.951457505326892*^9, 3.95145751272248*^9}, 
   3.951468953272963*^9, {3.951469462337899*^9, 3.951469486797255*^9}, {
   3.95196751452464*^9, 3.951967517767034*^9}},
 CellLabel->
  "Out[20]//MatrixForm=",ExpressionUUID->"451e1bb8-5de8-46b2-b0b2-\
196c121d3e9d"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Spin-up Hamiltonian", "Subsubsection",
 CellChangeTimes->{{3.951967680948778*^9, 
  3.951967687976231*^9}},ExpressionUUID->"2d45f8e0-210c-4168-ae85-\
47bc14ff68b5"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Hblock", "[", 
   RowBox[{"[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"1", ",", "2"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"1", ",", "2"}], "}"}]}], "]"}], "]"}], "//", 
  "MatrixForm"}]], "Input",
 CellChangeTimes->{{3.9519675219377747`*^9, 3.951967522706461*^9}},
 CellLabel->"In[22]:=",ExpressionUUID->"d0f409c1-6257-4ba7-8578-fbbb9c577d55"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{"B1", "-", "D1"}], ")"}], " ", 
        SuperscriptBox["\[Delta]z", "2"]}], "+", "\[Epsilon]0", "+", 
       "\[CapitalLambda]", "+", "\[Mu]0"}], 
      RowBox[{
       RowBox[{"-", "\[ImaginaryI]"}], " ", "A1", " ", "\[Delta]z"}]},
     {
      RowBox[{
       RowBox[{"-", "\[ImaginaryI]"}], " ", "A1", " ", "\[Delta]z"}], 
      RowBox[{
       RowBox[{"-", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"B1", "+", "D1"}], ")"}], " ", 
          SuperscriptBox["\[Delta]z", "2"]}], ")"}]}], "+", "\[Epsilon]0", 
       "+", "\[CapitalLambda]", "-", "\[Mu]0"}]}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.9519675197358093`*^9, 3.951967523038855*^9}},
 CellLabel->
  "Out[22]//MatrixForm=",ExpressionUUID->"2d14e5da-c7ec-4198-8cf3-\
9a068e983b6e"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Spin-down Hamiltonian", "Subsubsection",
 CellChangeTimes->{{3.951967680948778*^9, 
  3.951967694963237*^9}},ExpressionUUID->"9e73d35f-a40d-4c3f-b420-\
3749a4468567"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Hblock", "[", 
   RowBox[{"[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"3", ",", "4"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"3", ",", "4"}], "}"}]}], "]"}], "]"}], "//", 
  "MatrixForm"}]], "Input",
 CellChangeTimes->{{3.951967529328265*^9, 3.9519675357570543`*^9}},
 CellLabel->"In[23]:=",ExpressionUUID->"e8bc035d-2236-4443-a8a7-b15d3b805c92"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{"B1", "-", "D1"}], ")"}], " ", 
        SuperscriptBox["\[Delta]z", "2"]}], "+", "\[Epsilon]0", "-", 
       "\[CapitalLambda]", "+", "\[Mu]0"}], 
      RowBox[{"\[ImaginaryI]", " ", "A1", " ", "\[Delta]z"}]},
     {
      RowBox[{"\[ImaginaryI]", " ", "A1", " ", "\[Delta]z"}], 
      RowBox[{
       RowBox[{"-", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"B1", "+", "D1"}], ")"}], " ", 
          SuperscriptBox["\[Delta]z", "2"]}], ")"}]}], "+", "\[Epsilon]0", 
       "-", "\[CapitalLambda]", "-", "\[Mu]0"}]}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{3.95196753611755*^9},
 CellLabel->
  "Out[23]//MatrixForm=",ExpressionUUID->"7706869f-a844-498d-aa91-\
2cab9e698f8d"]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Wavefunctions", "Chapter",
 CellChangeTimes->{{3.951971967965248*^9, 
  3.951971972908445*^9}},ExpressionUUID->"6de4bd78-82cb-47e3-9748-\
1804f907acec"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"x", "[", "z_", "]"}], ":=", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{"c1", "+", "c2"}], ")"}], 
     RowBox[{"Cos", "[", 
      RowBox[{"I", " ", "\[Lambda]1", " ", "z"}], "]"}]}], "-", 
    RowBox[{"I", " ", 
     RowBox[{"(", 
      RowBox[{"c1", "-", "c2"}], ")"}], 
     RowBox[{"Sin", "[", 
      RowBox[{"I", " ", "\[Lambda]1", " ", "z"}], "]"}]}], "+", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"c3", "+", "c4"}], ")"}], 
     RowBox[{"Cos", "[", 
      RowBox[{"I", " ", "\[Lambda]2", " ", "z"}], "]"}]}], "-", 
    RowBox[{"I", " ", 
     RowBox[{"(", 
      RowBox[{"c3", "-", "c4"}], ")"}], 
     RowBox[{"Sin", "[", 
      RowBox[{"I", " ", "\[Lambda]2", " ", "z"}], "]"}]}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"x", "[", "z", "]"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"y", "[", "z_", "]"}], ":=", 
   RowBox[{
    RowBox[{"\[Gamma]1", 
     RowBox[{"(", 
      RowBox[{"c1", "-", "c2"}], ")"}], 
     RowBox[{"Cos", "[", 
      RowBox[{"I", " ", "\[Lambda]1", " ", "z"}], "]"}]}], "-", 
    RowBox[{"I", " ", "\[Gamma]1", 
     RowBox[{"(", 
      RowBox[{"c1", "+", "c2"}], ")"}], 
     RowBox[{"Sin", "[", 
      RowBox[{"I", " ", "\[Lambda]1", " ", "z"}], "]"}]}], "+", 
    RowBox[{"\[Gamma]2", 
     RowBox[{"(", 
      RowBox[{"c3", "-", "c4"}], ")"}], 
     RowBox[{"Cos", "[", 
      RowBox[{"I", " ", "\[Lambda]2", " ", "z"}], "]"}]}], "-", 
    RowBox[{"I", " ", "\[Gamma]2", 
     RowBox[{"(", 
      RowBox[{"c3", "+", "c4"}], ")"}], 
     RowBox[{"Sin", "[", 
      RowBox[{"I", " ", "\[Lambda]2", " ", "z"}], "]"}]}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"y", "[", "z", "]"}]}], "Input",
 CellChangeTimes->{{3.951971842379602*^9, 3.951971843549425*^9}, {
  3.951971883866897*^9, 3.9519719983803864`*^9}, {3.951972070955184*^9, 
  3.9519721085102158`*^9}, {3.9519721880194187`*^9, 3.9519722007828836`*^9}, {
  3.9519729954315147`*^9, 3.951973091779599*^9}, {3.951973152954064*^9, 
  3.951973186902403*^9}, {3.9519732275657988`*^9, 3.9519732730329638`*^9}},
 CellLabel->"In[83]:=",ExpressionUUID->"2569c449-3900-4b9b-9a0d-3f6b6024ce29"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"(", 
    RowBox[{"c1", "+", "c2"}], ")"}], " ", 
   RowBox[{"Cosh", "[", 
    RowBox[{"z", " ", "\[Lambda]1"}], "]"}]}], "+", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"c3", "+", "c4"}], ")"}], " ", 
   RowBox[{"Cosh", "[", 
    RowBox[{"z", " ", "\[Lambda]2"}], "]"}]}], "+", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"c1", "-", "c2"}], ")"}], " ", 
   RowBox[{"Sinh", "[", 
    RowBox[{"z", " ", "\[Lambda]1"}], "]"}]}], "+", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"c3", "-", "c4"}], ")"}], " ", 
   RowBox[{"Sinh", "[", 
    RowBox[{"z", " ", "\[Lambda]2"}], "]"}]}]}]], "Output",
 CellChangeTimes->{{3.951971910487649*^9, 3.951971949649703*^9}, 
   3.951971984979479*^9, {3.9519720975549917`*^9, 3.951972108945916*^9}, {
   3.951972196222568*^9, 3.951972201158352*^9}, {3.951973055746963*^9, 
   3.951973093216672*^9}, {3.951973183498332*^9, 3.951973187170981*^9}, {
   3.951973249290407*^9, 3.951973275423045*^9}},
 CellLabel->"Out[84]=",ExpressionUUID->"79fe32fd-77a8-41dd-8cd7-02248c3c92b3"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"(", 
    RowBox[{"c1", "-", "c2"}], ")"}], " ", "\[Gamma]1", " ", 
   RowBox[{"Cosh", "[", 
    RowBox[{"z", " ", "\[Lambda]1"}], "]"}]}], "+", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"c3", "-", "c4"}], ")"}], " ", "\[Gamma]2", " ", 
   RowBox[{"Cosh", "[", 
    RowBox[{"z", " ", "\[Lambda]2"}], "]"}]}], "+", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"c1", "+", "c2"}], ")"}], " ", "\[Gamma]1", " ", 
   RowBox[{"Sinh", "[", 
    RowBox[{"z", " ", "\[Lambda]1"}], "]"}]}], "+", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"c3", "+", "c4"}], ")"}], " ", "\[Gamma]2", " ", 
   RowBox[{"Sinh", "[", 
    RowBox[{"z", " ", "\[Lambda]2"}], "]"}]}]}]], "Output",
 CellChangeTimes->{{3.951971910487649*^9, 3.951971949649703*^9}, 
   3.951971984979479*^9, {3.9519720975549917`*^9, 3.951972108945916*^9}, {
   3.951972196222568*^9, 3.951972201158352*^9}, {3.951973055746963*^9, 
   3.951973093216672*^9}, {3.951973183498332*^9, 3.951973187170981*^9}, {
   3.951973249290407*^9, 3.951973275425352*^9}},
 CellLabel->"Out[86]=",ExpressionUUID->"757f13ec-b1d9-4a07-bd44-251a381c5b81"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"sol1", "=", 
   RowBox[{
    RowBox[{"Solve", "[", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"\[Lambda]1", 
          RowBox[{"(", 
           RowBox[{"c1", "-", "c2"}], ")"}]}], "+", 
         RowBox[{"\[Lambda]2", 
          RowBox[{"(", 
           RowBox[{"c3", "-", "c4"}], ")"}]}]}], "==", "0"}], "&&", 
       RowBox[{
        RowBox[{
         RowBox[{"\[Gamma]1", " ", "\[Lambda]1", 
          RowBox[{"(", 
           RowBox[{"c1", "+", "c2"}], ")"}]}], "+", 
         RowBox[{"\[Gamma]2", " ", "\[Lambda]2", 
          RowBox[{"(", 
           RowBox[{"c3", "+", "c4"}], ")"}]}]}], "==", "0"}]}], ",", 
      RowBox[{"{", 
       RowBox[{"c2", ",", "c4"}], "}"}]}], "]"}], "//", "FullSimplify"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"x", "[", "z", "]"}], "//.", "sol1"}], "//", 
  "FullSimplify"}]}], "Input",
 CellChangeTimes->{{3.951972111879183*^9, 3.9519721251171923`*^9}, {
  3.9519732791076*^9, 3.951973285166757*^9}, {3.9519737401626883`*^9, 
  3.9519737417554493`*^9}},
 CellLabel->"In[89]:=",ExpressionUUID->"212b07c0-43a4-4c05-b6bb-6e6ce6fd27f9"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   FractionBox["1", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"\[Gamma]1", "-", "\[Gamma]2"}], ")"}], " ", "\[Lambda]1", " ", 
     "\[Lambda]2"}]], 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"-", "2"}], " ", "\[Gamma]2", " ", "\[Lambda]2", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"c1", " ", "\[Lambda]1"}], "+", 
        RowBox[{"c3", " ", "\[Lambda]2"}]}], ")"}], " ", 
      RowBox[{"Cosh", "[", 
       RowBox[{"z", " ", "\[Lambda]1"}], "]"}]}], "+", 
     RowBox[{"2", " ", "\[Gamma]1", " ", "\[Lambda]1", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"c1", " ", "\[Lambda]1"}], "+", 
        RowBox[{"c3", " ", "\[Lambda]2"}]}], ")"}], " ", 
      RowBox[{"Cosh", "[", 
       RowBox[{"z", " ", "\[Lambda]2"}], "]"}]}], "-", 
     RowBox[{"2", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"c1", " ", "\[Gamma]1", " ", "\[Lambda]1"}], "+", 
        RowBox[{"c3", " ", "\[Gamma]2", " ", "\[Lambda]2"}]}], ")"}], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"-", "\[Lambda]2"}], " ", 
         RowBox[{"Sinh", "[", 
          RowBox[{"z", " ", "\[Lambda]1"}], "]"}]}], "+", 
        RowBox[{"\[Lambda]1", " ", 
         RowBox[{"Sinh", "[", 
          RowBox[{"z", " ", "\[Lambda]2"}], "]"}]}]}], ")"}]}]}], ")"}]}], 
  "}"}]], "Output",
 CellChangeTimes->{{3.9519721186344213`*^9, 3.951972125950529*^9}, 
   3.951973285431788*^9, 3.951973742322341*^9},
 CellLabel->"Out[90]=",ExpressionUUID->"bdb01c10-9e5d-482d-9d7e-5107016f727a"]
}, Open  ]],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.951971919570949*^9, 
  3.951971924757269*^9}},ExpressionUUID->"61335b42-af8c-4d2f-87ee-\
ddda30eda504"]
}, Open  ]]
},
WindowSize->{1080, 585},
WindowMargins->{{0, Automatic}, {42, 0}},
Magnification:>1.2 Inherited,
FrontEndVersion->"13.2 for Linux x86 (64-bit) (January 31, 2023)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"00adf517-afe2-41fa-a29e-e2f5245eafd9"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 89, 0, 80, "Section",ExpressionUUID->"a97cb485-0f6a-4fe5-9e1f-659489226105"],
Cell[CellGroupData[{
Cell[694, 26, 5042, 144, 714, "Input",ExpressionUUID->"dd31c27c-cd64-4cc6-a69f-caaea9e55af2"],
Cell[5739, 172, 2394, 71, 149, "Output",ExpressionUUID->"a72affea-6c57-4c60-99ce-7f82550f279e"]
}, Open  ]],
Cell[CellGroupData[{
Cell[8170, 248, 688, 17, 65, "Input",ExpressionUUID->"1f36291a-a7fe-4fd5-a574-1f96501cc938"],
Cell[8861, 267, 2090, 58, 145, "Output",ExpressionUUID->"d38e5f0d-653d-4595-bd52-272dae6a97c4"]
}, Open  ]],
Cell[CellGroupData[{
Cell[10988, 330, 639, 19, 35, "Input",ExpressionUUID->"680d8430-6ff6-4e17-911d-395abf804446"],
Cell[11630, 351, 2576, 73, 91, "Output",ExpressionUUID->"451e1bb8-5de8-46b2-b0b2-196c121d3e9d"]
}, Open  ]],
Cell[CellGroupData[{
Cell[14243, 429, 170, 3, 54, "Subsubsection",ExpressionUUID->"2d45f8e0-210c-4168-ae85-47bc14ff68b5"],
Cell[CellGroupData[{
Cell[14438, 436, 397, 11, 35, "Input",ExpressionUUID->"d0f409c1-6257-4ba7-8578-fbbb9c577d55"],
Cell[14838, 449, 1292, 37, 89, "Output",ExpressionUUID->"2d14e5da-c7ec-4198-8cf3-9a068e983b6e"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[16179, 492, 172, 3, 54, "Subsubsection",ExpressionUUID->"9e73d35f-a40d-4c3f-b420-3749a4468567"],
Cell[CellGroupData[{
Cell[16376, 499, 397, 11, 35, "Input",ExpressionUUID->"e8bc035d-2236-4443-a8a7-b15d3b805c92"],
Cell[16776, 512, 1219, 35, 89, "Output",ExpressionUUID->"7706869f-a844-498d-aa91-2cab9e698f8d"]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[18056, 554, 158, 3, 83, "Chapter",ExpressionUUID->"6de4bd78-82cb-47e3-9748-1804f907acec"],
Cell[CellGroupData[{
Cell[18239, 561, 2213, 60, 142, "Input",ExpressionUUID->"2569c449-3900-4b9b-9a0d-3f6b6024ce29"],
Cell[20455, 623, 1045, 27, 44, "Output",ExpressionUUID->"79fe32fd-77a8-41dd-8cd7-02248c3c92b3"],
Cell[21503, 652, 1117, 27, 44, "Output",ExpressionUUID->"757f13ec-b1d9-4a07-bd44-251a381c5b81"]
}, Open  ]],
Cell[CellGroupData[{
Cell[22657, 684, 1173, 33, 65, "Input",ExpressionUUID->"212b07c0-43a4-4c05-b6bb-6e6ce6fd27f9"],
Cell[23833, 719, 1570, 42, 98, "Output",ExpressionUUID->"bdb01c10-9e5d-482d-9d7e-5107016f727a"]
}, Open  ]],
Cell[25418, 764, 152, 3, 35, "Input",ExpressionUUID->"61335b42-af8c-4d2f-87ee-ddda30eda504"]
}, Open  ]]
}
]
*)

